[workspace]
name = "karina-tts-notification"
version = "0.1.0"
description = "Karina voice notification for Claude Code"
channels = ["conda-forge", "pytorch"]
platforms = ["linux-64", "osx-arm64"]

[dependencies]
python = "3.12.*"
ffmpeg = ">=6.0"
yt-dlp = ">=2024.1.0"
sox = ">=14.4.2"
pip = ">=24.0"

[feature.linux.dependencies]
cuda-toolkit = ">=12.0"
cudnn = ">=8.0"

[feature.linux]
platforms = ["linux-64"]

[feature.mac]
platforms = ["osx-arm64"]

[environments]
linux = { features = ["linux"], solve-group = "linux" }
mac = { features = ["mac"], solve-group = "mac" }

[tasks]
pipeline = "python src/pipeline.py"
install-deps = "pip install pydub torch soundfile huggingface-hub scipy loguru rich qwen-tts readchar noisereduce pedalboard pyloudnorm demucs"
install-deps-mac = "pip install pydub torch soundfile huggingface-hub scipy loguru rich qwen-tts readchar mlx mlx-whisper noisereduce pedalboard pyloudnorm demucs"
install-deps-linux = "pip install pydub torch soundfile huggingface-hub scipy loguru rich qwen-tts readchar faster-whisper noisereduce pedalboard pyloudnorm demucs"
post-process = "python src/post_process.py"
separate-vocals = "python -m demucs --two-stems vocals"
